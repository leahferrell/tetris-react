(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{21:function(e,t,n){},22:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var r,c,o,a=n(0),i=n.n(a),u=n(10),s=n.n(u),l=(n(21),n(22),n(16)),j=n(2),d=n(3),f=n(5),b=n(8);!function(e){e[e.Empty=0]="Empty",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Blue=3]="Blue",e[e.Purple=4]="Purple",e[e.Yellow=5]="Yellow",e[e.Teal=6]="Teal",e[e.Orange=7]="Orange"}(c||(c={})),function(e){e[e.I=0]="I",e[e.O=1]="O",e[e.T=2]="T",e[e.S=3]="S",e[e.Z=4]="Z",e[e.J=5]="J",e[e.L=6]="L"}(o||(o={}));var p=(r={},Object(b.a)(r,o.L,{bitmap:[[[0,0,1,0],[1,1,1,0]],[[1,0,0,0],[1,0,0,0],[1,1,0,0]],[[1,1,1,0],[1,0,0,0]],[[0,1,1,0],[0,0,1,0],[0,0,1,0]]],color:c.Orange}),Object(b.a)(r,o.O,{bitmap:[[[0,1,1,0],[0,1,1,0]]],color:c.Yellow}),Object(b.a)(r,o.T,{bitmap:[[[0,1,0,0],[1,1,1,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0]],[[1,1,1,0],[0,1,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Purple}),Object(b.a)(r,o.S,{bitmap:[[[0,1,1,0],[1,1,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0]],[[0,1,1,0],[1,1,0,0]],[[1,0,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Green}),Object(b.a)(r,o.Z,{bitmap:[[[1,1,0,0],[0,1,1,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0]],[[1,1,0,0],[0,1,1,0]],[[0,1,0,0],[1,1,0,0],[1,0,0,0]]],color:c.Red}),Object(b.a)(r,o.J,{bitmap:[[[1,0,0,0],[1,1,1,0]],[[1,1,0,0],[1,0,0,0],[1,0,0,0]],[[1,1,1,0],[0,0,1,0]],[[0,0,1,0],[0,0,1,0],[0,1,1,0]]],color:c.Blue}),Object(b.a)(r,o.I,{bitmap:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],color:c.Teal}),r),v=Object.keys(p).length,O=(n(29),n(1)),h=function(e){var t=e.isGhosted,n=e.color,r=["block",c.Empty!==n&&"block--".concat(c[n].toLowerCase()),t&&"block--ghosted"].filter(Boolean).join(" ");return Object(O.jsx)("div",{className:r})},x=(n(31),function(e){var t=[],n=0===e[0][0]&&0===e[1][0],r=0===e[0][e[0].length-1]&&0===e[1][e[0].length-1];return e.forEach((function(e){var c=[];e.forEach((function(t,o){0===o&&n||o===e.length-1&&r||c.push(t)})),t.push(c)})),t}),m=function(e){var t=e.type,n=e.orientation;if(null==t)return Object(O.jsx)("div",{});var r=x(p[t].bitmap[n]).map((function(e,n){var r=e.map((function(e,r){return Object(O.jsx)(h,{isGhosted:!1,color:e?p[t].color:c.Empty},"shape-block-".concat(n,"-").concat(r))}));return Object(O.jsx)("div",{className:"shape__row",children:r},"shape-row-".concat(n))}));return Object(O.jsx)("div",{className:"shape",children:r})},w=(n(32),function(e){var t=e.title,n=e.shape,r=e.onTouchStart;return Object(O.jsxs)("div",{onTouchStart:r,className:"shape-window",children:[Object(O.jsx)("p",{children:t}),n&&Object(O.jsx)(m,Object(f.a)({},n))]})}),y=n(11),g=n(7),E=function(e,t){return new Array(e).fill(I(t))},I=function(e){return new Array(e).fill({isGhosted:!1,color:c.Empty})},N={rows:E(20,10),gutterRows:E(20,10)},k=Object(g.b)({name:"grid",initialState:N,reducers:{update:function(e,t){return t.payload}}}),_=k.actions.update,R={gameOver:!1,level:1,lines:0,paused:!0,remainingLines:10,score:0,tickInterval:1e3},S=Object(g.b)({name:"game",initialState:R,reducers:{removedLines:function(e,t){var n=t.payload;return Object(f.a)(Object(f.a)({},e),{},{lines:e.lines+n,remainingLines:e.remainingLines-n,score:e.score+100*n})},pause:function(e){return null!=e.interval&&clearInterval(e.interval),Object(f.a)(Object(f.a)({},e),{},{interval:void 0,paused:!e.paused})},createdInterval:function(e,t){return null!=e.interval&&clearInterval(e.interval),Object(f.a)(Object(f.a)({},e),{},{interval:t.payload})}}}),G=S.actions,L=G.pause,T=G.removedLines,A=G.createdInterval,P=Object(g.b)({name:"current",initialState:null,reducers:{move:function(e,t){return null==e?e:Object(f.a)(Object(f.a)({},e),{},{position:t.payload})},rotate:function(e){return null==e?e:Object(f.a)(Object(f.a)({},e),{},{orientation:(e.orientation+1)%4})},update:function(e,t){return null!=t.payload?t.payload:e}}}),B=P.actions,J=function(){return{type:Math.floor(Math.random()*v),orientation:0}},C=J(),D=Object(g.b)({name:"next",initialState:C,reducers:{update:function(){return J()}}}),Y=D.actions,Z=Object(g.b)({name:"hold",initialState:null,reducers:{update:function(e,t){return null!=t.payload?t.payload:e}}}),K=Z.actions,M=function(){return function(e,t){var n=t(),r=n.grid,c=n.current,o=n.next,a=r.gutterRows;if(null==c)return H(e,o);if(!Q(a,c)){var i=q(r.rows),u=i.rowsRemovedCount,s=i.newGrid;return e(T(u)),e(_({rows:s,gutterRows:s})),H(e,o)}var l={rows:V(a,c),gutterRows:a};e(_(l));var j=c.position||{x:3,y:0},d={x:j.x,y:j.y+1};return e(B.move(d))}},F=function(e){return function(t,n){var r=n(),c=r.grid,o=r.current,a=r.next,i=c.gutterRows;if(null==o)return H(t,a);var u=o.position||{x:3,y:0},s={x:u.x+e,y:u.y},l=Q(i,{type:o.type,orientation:o.orientation,position:s});if(l){t(B.move(s));var j={rows:l?V(i,o):c.rows,gutterRows:l?i:c.rows};t(_(j))}}},H=function(e,t){return e(B.update(t)),e(Y.update())},U=function(){return function(e,t){var n=t(),r=n.current,c=n.hold,o=n.next;null!=c?e(B.update(c)):(e(B.update(o)),e(Y.update())),null!=r&&e(K.update(r))}},q=function(e){for(var t=e.filter((function(e){return-1!==e.findIndex((function(e){return e.color===c.Empty}))})),n=20-t.length,r=0;r<n;r++)t.unshift(new Array(10).fill({isGhosted:!1,color:c.Empty}));return{rowsRemovedCount:n,newGrid:t}},z=function(e){var t=p[e.type].bitmap[e.orientation],n=e.position||{x:3,y:0},r=[];return t.forEach((function(e,t){e.forEach((function(e,c){1===e&&r.push({x:n.x+c,y:n.y+t})}))})),r},Q=function(e,t){var n,r=z(t),o=Object(y.a)(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.x>=10||a.x<0)return!1;if(a.y>=20||a.y<0)return!1;if(e[a.y][a.x].color!==c.Empty)return!1}}catch(i){o.e(i)}finally{o.f()}return!0},V=function(e,t){var n=[];return e.forEach((function(e){var t=[];e.forEach((function(e){t.push(e)})),n.push(t)})),z(t).forEach((function(e){n[e.y][e.x]={isGhosted:!1,color:p[t.type].color}})),n},W=function(){var e=Object(d.c)((function(e){return e.next}));return Object(O.jsx)(w,{title:"Next",shape:e})},X=function(){var e=Object(d.c)((function(e){return e.hold})),t=Object(d.b)();return Object(O.jsx)(w,{title:"Hold",shape:e,onTouchStart:function(e){return t((function(e,t){e(U())}))}})},$=(n(33),function(e){var t=e.rows.map((function(e,t){var n=e.map((function(e,n){return Object(O.jsx)(h,{isGhosted:e.isGhosted,color:e.color},"block-".concat(t,"-").concat(n))}));return Object(O.jsx)("div",{className:"grid__row",children:n},"grid-row-".concat(t))}));return Object(O.jsx)("div",{className:"grid",children:t})}),ee=function(){var e=Object(d.c)((function(e){return e.grid}));return Object(O.jsx)($,{rows:e.rows})},te=(n(34),function(e){var t=e.label,n=e.value;return Object(O.jsxs)("div",{className:"stat",children:[Object(O.jsxs)("label",{children:[t,": "]}),Object(O.jsx)("span",{children:n})]})}),ne=function(){var e=Object(d.c)((function(e){return e.game}));return Object(O.jsxs)("div",{className:"stats-view-container",children:[Object(O.jsx)(te,{label:"Level",value:e.level}),Object(O.jsx)(te,{label:"Score",value:e.score}),Object(O.jsx)(te,{label:"Lines",value:e.lines})]})},re=(n(35),function(e){var t=e.isPaused,n=e.tickInterval,r=Object(d.c)((function(e){return e.game.interval})),c=Object(d.b)();return Object(a.useEffect)((function(){if(null==r){var e=setInterval((function(){c(M())}),n);c(A(e))}}),[c,n,t]),Object(O.jsxs)(i.a.Fragment,{children:[Object(O.jsx)("div",{className:"game-view__grid",children:Object(O.jsx)(ee,{})}),Object(O.jsxs)("div",{className:"game-view__side-bar",children:[Object(O.jsx)(W,{}),Object(O.jsx)(X,{}),Object(O.jsx)(ne,{})]})]})}),ce={ArrowDown:M,ArrowLeft:function(){return F(-1)},ArrowRight:function(){return F(1)},ArrowUp:function(){return e=1,function(t,n){var r=n(),c=r.grid,o=r.current,a=r.next,i=c.gutterRows;if(null==o)return H(t,a);var u=o.position||{x:3,y:0},s=Q(i,{type:o.type,orientation:(o.orientation+e)%4,position:u});if(s){t(B.rotate());var l={rows:s?V(i,o):c.rows,gutterRows:s?i:c.rows};t(_(l))}};var e}," ":function(){console.log("drop: hard")},p:L,P:L,Shift:U},oe=function(e){return function(t,n){var r=ce[e.key];r&&t(r())}},ae=(n(36),function(){var e=Object(d.b)();return Object(O.jsxs)("div",{onKeyDown:function(t){return e(oe(t))},tabIndex:-1,children:[Object(O.jsx)("p",{children:"Pause"}),Object(O.jsx)("button",{onClick:function(){return e(S.actions.pause())},children:"Start"})]})}),ie=(n(37),function(){var e=Object(d.c)((function(e){return e.game.paused})),t=Object(d.c)((function(e){return e.game.tickInterval})),n=Object(d.b)();return Object(O.jsxs)("div",{className:"tetris-page",onKeyDown:function(e){return n(oe(e))},tabIndex:-1,children:[Object(O.jsx)("div",{className:"tetris-page__title",children:"Tetris"}),Object(O.jsx)("div",{className:"tetris-page__content",children:e?Object(O.jsx)(ae,{}):Object(O.jsx)(re,{isPaused:e,tickInterval:t})})]})});var ue=function(){return Object(O.jsxs)("div",{className:"app",children:[Object(O.jsx)(l.a,{basename:"/",children:Object(O.jsx)(j.c,{children:Object(O.jsx)(j.a,{path:"/",element:Object(O.jsx)(ie,{})})})}),Object(O.jsxs)("footer",{className:"app__footer",children:["made with \u2665 by ",Object(O.jsx)("a",{href:"https://github.com/leahferrell/tetris-react",target:"_blank",rel:"noreferrer",children:"leahferrell"})]})]})},se=Object(g.a)({reducer:{current:P.reducer,game:S.reducer,grid:k.reducer,hold:Z.reducer,next:D.reducer}});s.a.render(Object(O.jsx)(d.a,{store:se,children:Object(O.jsx)(ue,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.f93712ca.chunk.js.map