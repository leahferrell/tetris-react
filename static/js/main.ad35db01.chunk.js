(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var r,c,o,i=n(0),a=n(6),s=n.n(a),u=(n(18),n(19),n(13)),l=(n(20),n(2)),j=(n(21),n(22),n(4));!function(e){e[e.Empty=0]="Empty",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Blue=3]="Blue",e[e.Purple=4]="Purple",e[e.Yellow=5]="Yellow",e[e.Teal=6]="Teal",e[e.Orange=7]="Orange"}(c||(c={})),function(e){e[e.I=0]="I",e[e.O=1]="O",e[e.T=2]="T",e[e.S=3]="S",e[e.Z=4]="Z",e[e.J=5]="J",e[e.L=6]="L"}(o||(o={}));var b=(r={},Object(j.a)(r,o.L,{bitmap:[[[0,0,1,0],[1,1,1,0]],[[1,0,0,0],[1,0,0,0],[1,1,0,0]],[[1,1,1,0],[1,0,0,0]],[[0,1,1,0],[0,0,1,0],[0,0,1,0]]],color:c.Orange}),Object(j.a)(r,o.O,{bitmap:[[[0,1,1,0],[0,1,1,0]]],color:c.Yellow}),Object(j.a)(r,o.T,{bitmap:[[[0,1,0,0],[1,1,1,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0]],[[1,1,1,0],[0,1,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Purple}),Object(j.a)(r,o.S,{bitmap:[[[0,1,1,0],[1,1,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0]],[[0,1,1,0],[1,1,0,0]],[[1,0,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Green}),Object(j.a)(r,o.Z,{bitmap:[[[1,1,0,0],[0,1,1,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0]],[[1,1,0,0],[0,1,1,0]],[[0,1,0,0],[1,1,0,0],[1,0,0,0]]],color:c.Red}),Object(j.a)(r,o.J,{bitmap:[[[1,0,0,0],[1,1,1,0]],[[1,1,0,0],[1,0,0,0],[1,0,0,0]],[[1,1,1,0],[0,0,1,0]],[[0,0,1,0],[0,0,1,0],[0,1,1,0]]],color:c.Blue}),Object(j.a)(r,o.I,{bitmap:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],color:c.Teal}),r),d=Object.keys(b).length,f=n(1),p=function(e){var t=e.isGhosted,n=e.color,r=["block",c.Empty!==n&&"block--".concat(c[n].toLowerCase()),t&&"block--ghosted"].filter(Boolean).join(" ");return Object(f.jsx)("div",{className:r})},O=(n(24),function(e){var t=e.type,n=e.orientation;e.position;if(null==t)return Object(f.jsx)("div",{});var r=b[t].bitmap[n].map((function(e,n){var r=e.map((function(e,r){return Object(f.jsx)(p,{isGhosted:!1,color:e?b[t].color:c.Empty},"shape-block-".concat(n,"-").concat(r))}));return Object(f.jsx)("div",{className:"shape__row",children:r},"shape-row-".concat(n))}));return Object(f.jsx)("div",{className:"shape",children:r})}),v=function(e){var t=e.title,n=e.shape;return Object(f.jsxs)("div",{className:"shape-window",children:[Object(f.jsx)("p",{children:t}),n&&Object(f.jsx)(O,Object(l.a)({},n))]})},h=(n(25),function(e){var t=e.rows.map((function(e,t){var n=e.map((function(e,n){return Object(f.jsx)(p,{isGhosted:e.isGhosted,color:e.color},"block-".concat(t,"-").concat(n))}));return Object(f.jsx)("div",{className:"grid__row",children:n},"grid-row-".concat(t))}));return Object(f.jsx)("div",{className:"grid",children:t})}),m=(n(26),function(e){var t=e.label,n=e.value;return Object(f.jsxs)("div",{className:"stat",children:[Object(f.jsx)("label",{children:t}),Object(f.jsx)("p",{children:n})]})}),x=function(e){var t=e.level,n=e.score,r=e.lines;return Object(f.jsxs)("div",{className:"stats-view-container",children:[Object(f.jsx)(m,{label:"Level",value:t}),Object(f.jsx)(m,{label:"Score",value:n}),Object(f.jsx)(m,{label:"Lines",value:r})]})},w=n(3),y=n(11),g=n(5),_=function(){return{type:Math.floor(Math.random()*d),orientation:0}},N={next:_()},E=Object(g.b)({name:"shapes",initialState:N,reducers:{swapHold:function(e){return null==e.current?e:null==e.hold?Object(l.a)(Object(l.a)({},e),{},{hold:e.current,current:e.next,next:_()}):Object(l.a)(Object(l.a)({},e),{},{hold:e.current,current:e.hold})},useNext:function(e){return Object(l.a)(Object(l.a)({},e),{},{current:e.next,next:_()})},rotateShape:function(e){return null==e.current?e:Object(l.a)(Object(l.a)({},e),{},{current:Object(l.a)(Object(l.a)({},e.current),{},{orientation:(e.current.orientation+1)%4})})},move:function(e,t){return null==e.current?e:Object(l.a)(Object(l.a)({},e),{},{current:Object(l.a)(Object(l.a)({},e.current),{},{position:t.payload})})}}}),R=E.actions,k=R.swapHold,G=R.useNext,L=R.rotateShape,I=R.move,S=function(e,t){return new Array(e).fill(new Array(t).fill({isGhosted:!1,color:c.Empty}))},A={rows:S(20,10),gutterRows:S(20,10)},T=Object(g.b)({name:"grid",initialState:A,reducers:{update:function(e,t){return t.payload}}}),B=T.actions.update,J={gameOver:!1,level:1,lines:0,paused:!1,remainingLines:10,score:0,tickInterval:1e3},P=Object(g.b)({name:"game",initialState:J,reducers:{removedLines:function(e,t){var n=t.payload;return Object(l.a)(Object(l.a)({},e),{},{lines:e.lines+n,remainingLines:e.remainingLines-n,score:e.score+100*n})},pause:function(e){return Object(l.a)(Object(l.a)({},e),{},{paused:!e.paused})}}}),C=P.actions,D=C.pause,H=C.removedLines,Y=function(){return function(e,t){var n=t(),r=n.grid,c=n.shapes,o=r.gutterRows,i=c.current;if(null==i)return e(G());if(!U(o,i)){var a=K(r.rows),s=a.rowsRemovedCount,u=a.newGrid;return e(H(s)),e(B({rows:u,gutterRows:u})),e(G())}var l={rows:q(o,i),gutterRows:o};e(B(l));var j=i.position||{x:3,y:0},b={x:j.x,y:j.y+1};return e(I(b))}},Z=function(e){return function(t,n){var r=n(),c=r.grid,o=r.shapes,i=c.gutterRows,a=o.current;if(null==a)return t(G());var s=a.position||{x:3,y:0},u={x:s.x+e,y:s.y},l=U(i,{type:a.type,orientation:a.orientation,position:u});if(l){t(I(u));var j={rows:l?q(i,a):c.rows,gutterRows:l?i:c.rows};t(B(j))}}},K=function(e){for(var t=e.filter((function(e){return-1!==e.findIndex((function(e){return e.color===c.Empty}))})),n=20-t.length,r=0;r<n;r++)t.unshift(new Array(10).fill({isGhosted:!1,color:c.Empty}));return{rowsRemovedCount:n,newGrid:t}},M=function(e){var t=b[e.type].bitmap[e.orientation],n=e.position||{x:3,y:0},r=[];return t.forEach((function(e,t){e.forEach((function(e,c){1===e&&r.push({x:n.x+c,y:n.y+t})}))})),r},U=function(e,t){var n,r=M(t),o=Object(y.a)(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i.x>=10||i.x<0)return!1;if(i.y>=20||i.y<0)return!1;if(e[i.y][i.x].color!==c.Empty)return!1}}catch(a){o.e(a)}finally{o.f()}return!0},q=function(e,t){var n=[];return e.forEach((function(e){var t=[];e.forEach((function(e){t.push(e)})),n.push(t)})),M(t).forEach((function(e){n[e.y][e.x]={isGhosted:!1,color:b[t.type].color}})),n},z={ArrowDown:Y,ArrowLeft:function(){return Z(-1)},ArrowRight:function(){return Z(1)},ArrowUp:function(){return e=1,function(t,n){var r=n(),c=r.grid,o=r.shapes,i=c.gutterRows,a=o.current;if(null==a)return t(G());var s=a.position||{x:3,y:0},u=U(i,{type:a.type,orientation:(a.orientation+e)%4,position:s});if(u){t(L());var l={rows:u?q(i,a):c.rows,gutterRows:u?i:c.rows};t(B(l))}};var e}," ":function(){console.log("drop: hard")},p:D,P:D,Shift:k},F=function(e){return function(t,n){console.log("test: ",e.key);var r=z[e.key];r&&t(r())}},Q=function(){var e=Object(w.c)((function(e){return e.grid})),t=Object(w.c)((function(e){return e.game})),n=Object(w.c)((function(e){return e.shapes})),r=Object(i.useState)(!1),c=Object(u.a)(r,2),o=c[0],a=c[1],s=Object(w.b)();return Object(i.useEffect)((function(){o||null==s||(setInterval((function(){s(Y())}),t.tickInterval),a(!0))}),[s,t.tickInterval,o]),Object(f.jsxs)("div",{className:"game-view-container",onKeyDown:function(e){return s(F(e))},tabIndex:-1,children:[Object(f.jsx)("div",{className:"game-view-container__title",children:"Tetris"}),Object(f.jsxs)("div",{className:"game-view-container__content",children:[Object(f.jsxs)("div",{className:"game-view-container__content__available-pieces",children:[Object(f.jsx)(v,{title:"Hold",shape:n.hold}),Object(f.jsx)(v,{title:"Next",shape:n.next})]}),Object(f.jsx)("div",{className:"game-view-container__content__grid",children:Object(f.jsx)(h,{rows:e.rows})}),Object(f.jsx)("div",{className:"game-view-container__content__stats",children:Object(f.jsx)(x,{level:t.level,lines:t.lines,score:t.score})})]})]})},V=function(){var e=Object(w.b)();return Object(f.jsx)("div",{onKeyDown:function(t){return e(F(t))},tabIndex:-1,children:"Pause"})};var W=function(){var e=Object(w.c)((function(e){return e.game.paused}));return Object(f.jsx)("div",{className:"app",children:e?Object(f.jsx)(V,{}):Object(f.jsx)(Q,{})})},X=n(12),$=n.n(X),ee=Object(g.a)({reducer:{grid:T.reducer,shapes:E.reducer,game:P.reducer},middleware:function(e){return e().concat($.a)}});s.a.render(Object(f.jsx)(w.a,{store:ee,children:Object(f.jsx)(W,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.ad35db01.chunk.js.map