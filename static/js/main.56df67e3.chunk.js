(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var r,c,o,a=n(0),i=n(10),s=n.n(i),u=(n(22),n(23),n(9)),l=(n(24),n(3)),j=(n(25),n(26),n(6));!function(e){e[e.Empty=0]="Empty",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Blue=3]="Blue",e[e.Purple=4]="Purple",e[e.Yellow=5]="Yellow",e[e.Teal=6]="Teal",e[e.Orange=7]="Orange"}(c||(c={})),function(e){e[e.I=0]="I",e[e.O=1]="O",e[e.T=2]="T",e[e.S=3]="S",e[e.Z=4]="Z",e[e.J=5]="J",e[e.L=6]="L"}(o||(o={}));var b=(r={},Object(j.a)(r,o.L,{bitmap:[[[0,0,1,0],[1,1,1,0]],[[1,0,0,0],[1,0,0,0],[1,1,0,0]],[[1,1,1,0],[1,0,0,0]],[[0,1,1,0],[0,0,1,0],[0,0,1,0]]],color:c.Orange}),Object(j.a)(r,o.O,{bitmap:[[[0,1,1,0],[0,1,1,0]]],color:c.Yellow}),Object(j.a)(r,o.T,{bitmap:[[[0,1,0,0],[1,1,1,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0]],[[1,1,1,0],[0,1,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Purple}),Object(j.a)(r,o.S,{bitmap:[[[0,1,1,0],[1,1,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0]],[[0,1,1,0],[1,1,0,0]],[[1,0,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Green}),Object(j.a)(r,o.Z,{bitmap:[[[1,1,0,0],[0,1,1,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0]],[[1,1,0,0],[0,1,1,0]],[[0,1,0,0],[1,1,0,0],[1,0,0,0]]],color:c.Red}),Object(j.a)(r,o.J,{bitmap:[[[1,0,0,0],[1,1,1,0]],[[1,1,0,0],[1,0,0,0],[1,0,0,0]],[[1,1,1,0],[0,0,1,0]],[[0,0,1,0],[0,0,1,0],[0,1,1,0]]],color:c.Blue}),Object(j.a)(r,o.I,{bitmap:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],color:c.Teal}),r),d=Object.keys(b).length,f=n(1),p=function(e){var t=e.isGhosted,n=e.color,r=["block",c.Empty!==n&&"block--".concat(c[n].toLowerCase()),t&&"block--ghosted"].filter(Boolean).join(" ");return Object(f.jsx)("div",{className:r})},O=(n(28),function(e){var t=e.type,n=e.orientation;e.position;if(null==t)return Object(f.jsx)("div",{});var r=b[t].bitmap[n].map((function(e,n){var r=e.map((function(e,r){return Object(f.jsx)(p,{isGhosted:!1,color:e?b[t].color:c.Empty},"shape-block-".concat(n,"-").concat(r))}));return Object(f.jsx)("div",{className:"shape__row",children:r},"shape-row-".concat(n))}));return Object(f.jsx)("div",{className:"shape",children:r})}),v=function(e){var t=e.title,n=e.shape;return Object(f.jsxs)("div",{className:"shape-window",children:[Object(f.jsx)("p",{children:t}),n&&Object(f.jsx)(O,Object(l.a)({},n))]})},h=(n(29),function(e){var t=e.rows.map((function(e,t){var n=e.map((function(e,n){return Object(f.jsx)(p,{isGhosted:e.isGhosted,color:e.color},"block-".concat(t,"-").concat(n))}));return Object(f.jsx)("div",{className:"grid__row",children:n},"grid-row-".concat(t))}));return Object(f.jsx)("div",{className:"grid",children:t})}),m=(n(30),function(e){var t=e.label,n=e.value;return Object(f.jsxs)("div",{className:"stat",children:[Object(f.jsx)("label",{children:t}),Object(f.jsx)("p",{children:n})]})}),x=function(e){var t=e.level,n=e.score,r=e.lines;return Object(f.jsxs)("div",{className:"stats-view-container",children:[Object(f.jsx)(m,{label:"Level",value:t}),Object(f.jsx)(m,{label:"Score",value:n}),Object(f.jsx)(m,{label:"Lines",value:r})]})},w=n(7),y=n(11),g=n(8),_=function(){return{type:Math.floor(Math.random()*d),orientation:0}},N={next:_()},E=Object(g.b)({name:"shapes",initialState:N,reducers:{swapHold:function(e){return null==e.current?e:null==e.hold?Object(l.a)(Object(l.a)({},e),{},{hold:e.current,current:e.next,next:_()}):Object(l.a)(Object(l.a)({},e),{},{hold:e.current,current:e.hold})},useNext:function(e){return Object(l.a)(Object(l.a)({},e),{},{current:e.next,next:_()})},rotateShape:function(e){return null==e.current?e:Object(l.a)(Object(l.a)({},e),{},{current:Object(l.a)(Object(l.a)({},e.current),{},{orientation:(e.current.orientation+1)%4})})},move:function(e,t){return null==e.current?e:Object(l.a)(Object(l.a)({},e),{},{current:Object(l.a)(Object(l.a)({},e.current),{},{position:t.payload})})}}}),R=E.actions,k=R.swapHold,G=R.useNext,L=R.rotateShape,S=R.move,I=function(e,t){return new Array(e).fill(new Array(t).fill({isGhosted:!1,color:c.Empty}))},A={rows:I(20,10),gutterRows:I(20,10)},T=Object(g.b)({name:"grid",initialState:A,reducers:{update:function(e,t){return t.payload}}}),B=T.actions.update,J={gameOver:!1,level:1,lines:0,paused:!1,remainingLines:10,score:0,tickInterval:1e3},P=Object(g.b)({name:"game",initialState:J,reducers:{removedLines:function(e,t){var n=t.payload;return Object(l.a)(Object(l.a)({},e),{},{lines:e.lines+n,remainingLines:e.remainingLines-n,score:e.score+100*n})},pause:function(e){return Object(l.a)(Object(l.a)({},e),{},{paused:!e.paused})}}}),C=P.actions,H=C.pause,Y=C.removedLines,Z=function(){return function(e,t){var n=t(),r=n.grid,c=n.shapes,o=r.gutterRows,a=c.current;if(null==a)return e(G());if(!U(o,a)){var i=M(r.rows),s=i.rowsRemovedCount,u=i.newGrid;return e(Y(s)),e(B({rows:u,gutterRows:u})),e(G())}var l={rows:q(o,a),gutterRows:o};e(B(l));var j=a.position||{x:3,y:0},b={x:j.x,y:j.y+1};return e(S(b))}},D=function(e){return function(t,n){var r=n(),c=r.grid,o=r.shapes,a=c.gutterRows,i=o.current;if(null==i)return t(G());var s=i.position||{x:3,y:0},u={x:s.x+e,y:s.y},l=U(a,{type:i.type,orientation:i.orientation,position:u});if(l){t(S(u));var j={rows:l?q(a,i):c.rows,gutterRows:l?a:c.rows};t(B(j))}}},M=function(e){for(var t=e.filter((function(e){return-1!==e.findIndex((function(e){return e.color===c.Empty}))})),n=20-t.length,r=0;r<n;r++)t.unshift(new Array(10).fill({isGhosted:!1,color:c.Empty}));return{rowsRemovedCount:n,newGrid:t}},K=function(e){var t=b[e.type].bitmap[e.orientation],n=e.position||{x:3,y:0},r=[];return t.forEach((function(e,t){e.forEach((function(e,c){1===e&&r.push({x:n.x+c,y:n.y+t})}))})),r},U=function(e,t){var n,r=K(t),o=Object(y.a)(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.x>=10||a.x<0)return!1;if(a.y>=20||a.y<0)return!1;if(e[a.y][a.x].color!==c.Empty)return!1}}catch(i){o.e(i)}finally{o.f()}return!0},q=function(e,t){var n=[];return e.forEach((function(e){var t=[];e.forEach((function(e){t.push(e)})),n.push(t)})),K(t).forEach((function(e){n[e.y][e.x]={isGhosted:!1,color:b[t.type].color}})),n},z={ArrowDown:Z,ArrowLeft:function(){return D(-1)},ArrowRight:function(){return D(1)},ArrowUp:function(){return e=1,function(t,n){var r=n(),c=r.grid,o=r.shapes,a=c.gutterRows,i=o.current;if(null==i)return t(G());var s=i.position||{x:3,y:0},u=U(a,{type:i.type,orientation:(i.orientation+e)%4,position:s});if(u){t(L());var l={rows:u?q(a,i):c.rows,gutterRows:u?a:c.rows};t(B(l))}};var e}," ":function(){console.log("drop: hard")},p:H,P:H,Shift:k},F=function(){var e=Object(w.c)((function(e){return e.grid})),t=Object(w.c)((function(e){return e.game})),n=Object(w.c)((function(e){return e.shapes})),r=Object(a.useState)(!1),c=Object(u.a)(r,2),o=c[0],i=c[1],s=Object(w.b)();return Object(a.useEffect)((function(){o||null==s||(setInterval((function(){s(Z())}),t.tickInterval),i(!0))}),[s,t.tickInterval,o]),Object(f.jsxs)("div",{className:"game-view-container",onKeyDown:function(e){return s(function(e){return function(t,n){console.log("test: ",e.key);var r=z[e.key];r&&t(r())}}(e))},tabIndex:-1,children:[Object(f.jsx)("div",{className:"game-view-container__title",children:"Tetris"}),Object(f.jsxs)("div",{className:"game-view-container__content",children:[Object(f.jsxs)("div",{className:"game-view-container__content__available-pieces",children:[Object(f.jsx)(v,{title:"Hold",shape:n.hold}),Object(f.jsx)(v,{title:"Next",shape:n.next})]}),Object(f.jsx)("div",{className:"game-view-container__content__grid",children:Object(f.jsx)(h,{rows:e.rows})}),Object(f.jsx)("div",{className:"game-view-container__content__stats",children:Object(f.jsx)(x,{level:t.level,lines:t.lines,score:t.score})})]})]})},Q=n(16),V=n(2);var W=function(){return Object(w.c)((function(e){return e.game.paused})),Object(f.jsx)("div",{className:"app",children:Object(f.jsx)(Q.a,{basename:"/",children:Object(f.jsx)(V.c,{children:Object(f.jsx)(V.a,{path:"/",element:Object(f.jsx)(F,{})})})})})},X=n(17),$=n.n(X),ee=Object(g.a)({reducer:{grid:T.reducer,shapes:E.reducer,game:P.reducer},middleware:function(e){return e().concat($.a)}});s.a.render(Object(f.jsx)(w.a,{store:ee,children:Object(f.jsx)(W,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.56df67e3.chunk.js.map