(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{21:function(e,t,n){},22:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r,c,o,a=n(0),i=n(10),s=n.n(i),u=(n(21),n(22),n(9)),l=n(7),j=(n(29),n(30),n(6));!function(e){e[e.Empty=0]="Empty",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Blue=3]="Blue",e[e.Purple=4]="Purple",e[e.Yellow=5]="Yellow",e[e.Teal=6]="Teal",e[e.Orange=7]="Orange"}(c||(c={})),function(e){e[e.I=0]="I",e[e.O=1]="O",e[e.T=2]="T",e[e.S=3]="S",e[e.Z=4]="Z",e[e.J=5]="J",e[e.L=6]="L"}(o||(o={}));var b=(r={},Object(j.a)(r,o.L,{bitmap:[[[0,0,1,0],[1,1,1,0]],[[1,0,0,0],[1,0,0,0],[1,1,0,0]],[[1,1,1,0],[1,0,0,0]],[[0,1,1,0],[0,0,1,0],[0,0,1,0]]],color:c.Orange}),Object(j.a)(r,o.O,{bitmap:[[[0,1,1,0],[0,1,1,0]]],color:c.Yellow}),Object(j.a)(r,o.T,{bitmap:[[[0,1,0,0],[1,1,1,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0]],[[1,1,1,0],[0,1,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Purple}),Object(j.a)(r,o.S,{bitmap:[[[0,1,1,0],[1,1,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0]],[[0,1,1,0],[1,1,0,0]],[[1,0,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Green}),Object(j.a)(r,o.Z,{bitmap:[[[1,1,0,0],[0,1,1,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0]],[[1,1,0,0],[0,1,1,0]],[[0,1,0,0],[1,1,0,0],[1,0,0,0]]],color:c.Red}),Object(j.a)(r,o.J,{bitmap:[[[1,0,0,0],[1,1,1,0]],[[1,1,0,0],[1,0,0,0],[1,0,0,0]],[[1,1,1,0],[0,0,1,0]],[[0,0,1,0],[0,0,1,0],[0,1,1,0]]],color:c.Blue}),Object(j.a)(r,o.I,{bitmap:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],color:c.Teal}),r),d=Object.keys(b).length,f=n(1),p=function(e){var t=e.isGhosted,n=e.color,r=["block",c.Empty!==n&&"block--".concat(c[n].toLowerCase()),t&&"block--ghosted"].filter(Boolean).join(" ");return Object(f.jsx)("div",{className:r})},O=function(e){var t=e.rows.map((function(e,t){var n=e.map((function(e,n){return Object(f.jsx)(p,{isGhosted:e.isGhosted,color:e.color},"block-".concat(t,"-").concat(n))}));return Object(f.jsx)("div",{className:"grid__row",children:n},"grid-row-".concat(t))}));return Object(f.jsx)("div",{className:"grid",children:t})},h=n(3),v=(n(32),n(33),function(e){var t=[],n=0===e[0][0]&&0===e[1][0],r=0===e[0][e[0].length-1]&&0===e[1][e[0].length-1];return e.forEach((function(e){var c=[];e.forEach((function(t,o){0===o&&n||o===e.length-1&&r||c.push(t)})),t.push(c)})),t}),m=function(e){var t=e.type,n=e.orientation;e.position;if(null==t)return Object(f.jsx)("div",{});var r=v(b[t].bitmap[n]).map((function(e,n){var r=e.map((function(e,r){return Object(f.jsx)(p,{isGhosted:!1,color:e?b[t].color:c.Empty},"shape-block-".concat(n,"-").concat(r))}));return Object(f.jsx)("div",{className:"shape__row",children:r},"shape-row-".concat(n))}));return Object(f.jsx)("div",{className:"shape",children:r})},x=function(e){var t=e.title,n=e.shape;return Object(f.jsxs)("div",{className:"shape-window",children:[Object(f.jsx)("p",{children:t}),n&&Object(f.jsx)(m,Object(h.a)({},n))]})},w=n(11),g=n(8),y=function(){return{type:Math.floor(Math.random()*d),orientation:0}},E={next:y()},N=Object(g.b)({name:"shapes",initialState:E,reducers:{swapHold:function(e){return null==e.current?e:null==e.hold?Object(h.a)(Object(h.a)({},e),{},{hold:e.current,current:e.next,next:y()}):Object(h.a)(Object(h.a)({},e),{},{hold:e.current,current:e.hold})},useNext:function(e){return Object(h.a)(Object(h.a)({},e),{},{current:e.next,next:y()})},rotateShape:function(e){return null==e.current?e:Object(h.a)(Object(h.a)({},e),{},{current:Object(h.a)(Object(h.a)({},e.current),{},{orientation:(e.current.orientation+1)%4})})},move:function(e,t){return null==e.current?e:Object(h.a)(Object(h.a)({},e),{},{current:Object(h.a)(Object(h.a)({},e.current),{},{position:t.payload})})}}}),_=N.actions,R=_.swapHold,k=_.useNext,G=_.rotateShape,L=_.move,S=function(e,t){return new Array(e).fill(new Array(t).fill({isGhosted:!1,color:c.Empty}))},I={rows:S(20,10),gutterRows:S(20,10)},A=Object(g.b)({name:"grid",initialState:I,reducers:{update:function(e,t){return t.payload}}}),T=A.actions.update,B={gameOver:!1,level:1,lines:0,paused:!1,remainingLines:10,score:0,tickInterval:1e3},J=Object(g.b)({name:"game",initialState:B,reducers:{removedLines:function(e,t){var n=t.payload;return Object(h.a)(Object(h.a)({},e),{},{lines:e.lines+n,remainingLines:e.remainingLines-n,score:e.score+100*n})},pause:function(e){return Object(h.a)(Object(h.a)({},e),{},{paused:!e.paused})}}}),P=J.actions,C=P.pause,H=P.removedLines,Y=function(){return function(e,t){var n=t(),r=n.grid,c=n.shapes,o=r.gutterRows,a=c.current;if(null==a)return e(k());if(!K(o,a)){var i=D(r.rows),s=i.rowsRemovedCount,u=i.newGrid;return e(H(s)),e(T({rows:u,gutterRows:u})),e(k())}var l={rows:U(o,a),gutterRows:o};e(T(l));var j=a.position||{x:3,y:0},b={x:j.x,y:j.y+1};return e(L(b))}},Z=function(e){return function(t,n){var r=n(),c=r.grid,o=r.shapes,a=c.gutterRows,i=o.current;if(null==i)return t(k());var s=i.position||{x:3,y:0},u={x:s.x+e,y:s.y},l=K(a,{type:i.type,orientation:i.orientation,position:u});if(l){t(L(u));var j={rows:l?U(a,i):c.rows,gutterRows:l?a:c.rows};t(T(j))}}},D=function(e){for(var t=e.filter((function(e){return-1!==e.findIndex((function(e){return e.color===c.Empty}))})),n=20-t.length,r=0;r<n;r++)t.unshift(new Array(10).fill({isGhosted:!1,color:c.Empty}));return{rowsRemovedCount:n,newGrid:t}},M=function(e){var t=b[e.type].bitmap[e.orientation],n=e.position||{x:3,y:0},r=[];return t.forEach((function(e,t){e.forEach((function(e,c){1===e&&r.push({x:n.x+c,y:n.y+t})}))})),r},K=function(e,t){var n,r=M(t),o=Object(w.a)(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.x>=10||a.x<0)return!1;if(a.y>=20||a.y<0)return!1;if(e[a.y][a.x].color!==c.Empty)return!1}}catch(i){o.e(i)}finally{o.f()}return!0},U=function(e,t){var n=[];return e.forEach((function(e){var t=[];e.forEach((function(e){t.push(e)})),n.push(t)})),M(t).forEach((function(e){n[e.y][e.x]={isGhosted:!1,color:b[t.type].color}})),n},q={ArrowDown:Y,ArrowLeft:function(){return Z(-1)},ArrowRight:function(){return Z(1)},ArrowUp:function(){return e=1,function(t,n){var r=n(),c=r.grid,o=r.shapes,a=c.gutterRows,i=o.current;if(null==i)return t(k());var s=i.position||{x:3,y:0},u=K(a,{type:i.type,orientation:(i.orientation+e)%4,position:s});if(u){t(G());var l={rows:u?U(a,i):c.rows,gutterRows:u?a:c.rows};t(T(l))}};var e}," ":function(){console.log("drop: hard")},p:C,P:C,Shift:R},z=(n(34),function(e){var t=e.label,n=e.value;return Object(f.jsxs)("div",{className:"stat",children:[Object(f.jsxs)("label",{children:[t,": "]}),Object(f.jsx)("span",{children:n})]})}),F=function(e){var t=e.level,n=e.score,r=e.lines;return Object(f.jsxs)("div",{className:"stats-view-container",children:[Object(f.jsx)(z,{label:"Level",value:t}),Object(f.jsx)(z,{label:"Score",value:n}),Object(f.jsx)(z,{label:"Lines",value:r})]})},Q=(n(35),function(){var e=Object(l.c)((function(e){return e.grid})),t=Object(l.c)((function(e){return e.game})),n=Object(l.c)((function(e){return e.shapes})),r=Object(a.useState)(!1),c=Object(u.a)(r,2),o=c[0],i=c[1],s=Object(l.b)();return Object(a.useEffect)((function(){o||null==s||(setInterval((function(){s(Y())}),t.tickInterval),i(!0))}),[s,t.tickInterval,o]),Object(f.jsxs)("div",{className:"game-view-container",onKeyDown:function(e){return s(function(e){return function(t,n){var r=q[e.key];r&&t(r())}}(e))},tabIndex:-1,children:[Object(f.jsx)("div",{className:"game-view-container__title",children:"Tetris"}),Object(f.jsxs)("div",{className:"game-view-container__content",children:[Object(f.jsx)("div",{className:"game-view-container__content__grid",children:Object(f.jsx)(O,{rows:e.rows})}),Object(f.jsxs)("div",{className:"game-view-container__content__side-bar",children:[Object(f.jsx)(x,{title:"Next",shape:n.next}),Object(f.jsx)(x,{title:"Hold",shape:n.hold}),Object(f.jsx)(F,{level:t.level,lines:t.lines,score:t.score})]})]})]})}),V=n(16),W=n(2);var X=function(){return Object(l.c)((function(e){return e.game.paused})),Object(f.jsx)("div",{className:"app",children:Object(f.jsx)(V.a,{basename:"/",children:Object(f.jsx)(W.c,{children:Object(f.jsx)(W.a,{path:"/",element:Object(f.jsx)(Q,{})})})})})},$=Object(g.a)({reducer:{grid:A.reducer,shapes:N.reducer,game:J.reducer}});s.a.render(Object(f.jsx)(l.a,{store:$,children:Object(f.jsx)(X,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.b6991d7a.chunk.js.map