(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{27:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r,c,a,i=n(0),o=n.n(i),u=n(10),s=n.n(u),l=n(3),j=n(16),f=n(2),b=n(4),d=n(8);!function(e){e[e.Empty=0]="Empty",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Blue=3]="Blue",e[e.Purple=4]="Purple",e[e.Yellow=5]="Yellow",e[e.Teal=6]="Teal",e[e.Orange=7]="Orange"}(c||(c={})),function(e){e[e.I=0]="I",e[e.O=1]="O",e[e.T=2]="T",e[e.S=3]="S",e[e.Z=4]="Z",e[e.J=5]="J",e[e.L=6]="L"}(a||(a={}));var O=(r={},Object(d.a)(r,a.L,{bitmap:[[[0,0,1,0],[1,1,1,0]],[[1,0,0,0],[1,0,0,0],[1,1,0,0]],[[1,1,1,0],[1,0,0,0]],[[0,1,1,0],[0,0,1,0],[0,0,1,0]]],color:c.Orange}),Object(d.a)(r,a.O,{bitmap:[[[0,1,1,0],[0,1,1,0]]],color:c.Yellow}),Object(d.a)(r,a.T,{bitmap:[[[0,1,0,0],[1,1,1,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0]],[[1,1,1,0],[0,1,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Purple}),Object(d.a)(r,a.S,{bitmap:[[[0,1,1,0],[1,1,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0]],[[0,1,1,0],[1,1,0,0]],[[1,0,0,0],[1,1,0,0],[0,1,0,0]]],color:c.Green}),Object(d.a)(r,a.Z,{bitmap:[[[1,1,0,0],[0,1,1,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0]],[[1,1,0,0],[0,1,1,0]],[[0,1,0,0],[1,1,0,0],[1,0,0,0]]],color:c.Red}),Object(d.a)(r,a.J,{bitmap:[[[1,0,0,0],[1,1,1,0]],[[1,1,0,0],[1,0,0,0],[1,0,0,0]],[[1,1,1,0],[0,0,1,0]],[[0,0,1,0],[0,0,1,0],[0,1,1,0]]],color:c.Blue}),Object(d.a)(r,a.I,{bitmap:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],color:c.Teal}),r),v=Object.keys(O).length,p=(n(27),n(1)),h=function(e){var t=e.isGhosted,n=e.color,r=["block",c.Empty!==n&&"block--".concat(c[n].toLowerCase()),t&&"block--ghosted"].filter(Boolean).join(" ");return Object(p.jsx)("div",{className:r})},m=(n(29),function(e){var t=[],n=0===e[0][0]&&0===e[1][0],r=0===e[0][e[0].length-1]&&0===e[1][e[0].length-1];return e.forEach((function(e){var c=[];e.forEach((function(t,a){0===a&&n||a===e.length-1&&r||c.push(t)})),t.push(c)})),t}),x=function(e){var t=e.type,n=e.orientation;if(null==t)return Object(p.jsx)("div",{});var r=m(O[t].bitmap[n]).map((function(e,n){var r=e.map((function(e,r){return Object(p.jsx)(h,{isGhosted:!1,color:e?O[t].color:c.Empty},"shape-block-".concat(n,"-").concat(r))}));return Object(p.jsx)("div",{className:"shape__row",children:r},"shape-row-".concat(n))}));return Object(p.jsx)("div",{className:"shape",children:r})},g=(n(30),function(e){var t=e.title,n=e.shape,r=e.onTouchStart;return Object(p.jsxs)("div",{onTouchStart:r,className:"shape-window",children:[Object(p.jsx)("p",{children:t}),n&&Object(p.jsx)(x,Object(b.a)({},n))]})}),w=n(11),y=n(7),N={gameOver:!1,hasStarted:!1,level:1,lines:0,paused:!0,remainingLines:10,score:0,tickInterval:1e3},S=Object(y.b)({name:"game",initialState:N,reducers:{removedLines:function(e,t){var n=t.payload;return Object(b.a)(Object(b.a)({},e),{},{lines:e.lines+n,remainingLines:e.remainingLines-n,score:e.score+100*n})},pause:function(e){return null!=e.interval&&clearInterval(e.interval),Object(b.a)(Object(b.a)({},e),{},{interval:void 0,paused:!e.paused})},createdInterval:function(e,t){return null!=e.interval&&clearInterval(e.interval),Object(b.a)(Object(b.a)({},e),{},{interval:t.payload})},start:function(){return Object(b.a)(Object(b.a)({},N),{},{hasStarted:!0,paused:!1})},gameOver:function(e){return null!=e.interval&&clearInterval(e.interval),Object(b.a)(Object(b.a)({},e),{},{paused:!0,gameOver:!0})}}}),k=S.actions,E=function(e,t){return new Array(e).fill(I(t))},I=function(e){return new Array(e).fill({isGhosted:!1,color:c.Empty})},R={rows:E(20,10),gutterRows:E(20,10)},_=Object(y.b)({name:"grid",initialState:R,reducers:{update:function(e,t){return t.payload},clear:function(){return R}}}),G=_.actions,L=Object(y.b)({name:"current",initialState:null,reducers:{move:function(e,t){return null==e?e:Object(b.a)(Object(b.a)({},e),{},{position:t.payload})},rotate:function(e){return null==e?e:Object(b.a)(Object(b.a)({},e),{},{orientation:(e.orientation+1)%4})},update:function(e,t){return null!=t.payload?t.payload:e},clear:function(){return null}}}),T=L.actions,A=Object(y.b)({name:"hold",initialState:null,reducers:{update:function(e,t){return null!=t.payload?t.payload:e},clear:function(){return null}}}),C=A.actions,P=function(){return{type:Math.floor(Math.random()*v),orientation:0}},B=P(),J=Object(y.b)({name:"next",initialState:B,reducers:{update:function(){return P()},clear:function(){return P()}}}),D=J.actions,Y=function(){return function(e){e(T.clear()),e(D.clear()),e(C.clear()),e(G.clear()),e(k.start())}},Z=function(){return function(e,t){var n=t(),r=n.grid,c=n.current,a=n.next,i=r.gutterRows;if(null==c)return M(e,a);if(!z(i,c)){var o=U(r.rows),u=o.rowsRemovedCount,s=o.newGrid;if(u>0&&e(k.removedLines(u)),H())return e(k.gameOver());var l={rows:s,gutterRows:s};return e(G.update(l)),M(e,a)}var j={rows:Q(i,c),gutterRows:i};e(G.update(j));var f=c.position||{x:3,y:0},b={x:f.x,y:f.y+1};return e(T.move(b))}},K=function(e){return function(t,n){var r=n(),c=r.grid,a=r.current,i=r.next,o=c.gutterRows;if(null==a)return M(t,i);var u=a.position||{x:3,y:0},s={x:u.x+e,y:u.y},l=z(o,{type:a.type,orientation:a.orientation,position:s});if(l){t(T.move(s));var j={rows:l?Q(o,a):c.rows,gutterRows:l?o:c.rows};t(G.update(j))}}},M=function(e,t){return e(T.update(t)),e(D.update())},F=function(){return function(e,t){var n=t(),r=n.current,c=n.hold,a=n.next;null!=c?e(T.update(c)):(e(T.update(a)),e(D.update())),null!=r&&e(C.update(r))}},H=function(){return!1},U=function(e){for(var t=e.filter((function(e){return-1!==e.findIndex((function(e){return e.color===c.Empty}))})),n=20-t.length,r=0;r<n;r++)t.unshift(new Array(10).fill({isGhosted:!1,color:c.Empty}));return{rowsRemovedCount:n,newGrid:t}},q=function(e){var t=O[e.type].bitmap[e.orientation],n=e.position||{x:3,y:0},r=[];return t.forEach((function(e,t){e.forEach((function(e,c){1===e&&r.push({x:n.x+c,y:n.y+t})}))})),r},z=function(e,t){var n,r=q(t),a=Object(w.a)(r);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.x>=10||i.x<0)return!1;if(i.y>=20||i.y<0)return!1;if(e[i.y][i.x].color!==c.Empty)return!1}}catch(o){a.e(o)}finally{a.f()}return!0},Q=function(e,t){var n=[];return e.forEach((function(e){var t=[];e.forEach((function(e){t.push(e)})),n.push(t)})),q(t).forEach((function(e){n[e.y][e.x]={isGhosted:!1,color:O[t.type].color}})),n},V=function(){var e=Object(l.c)((function(e){return e.next}));return Object(p.jsx)(g,{title:"Next",shape:e})},W=function(){var e=Object(l.c)((function(e){return e.hold})),t=Object(l.b)();return Object(p.jsx)(g,{title:"Hold",shape:e,onTouchStart:function(){return t((function(e){e(F())}))}})},X=(n(31),function(e){var t=e.rows.map((function(e,t){var n=e.map((function(e,n){return Object(p.jsx)(h,{isGhosted:e.isGhosted,color:e.color},"block-".concat(t,"-").concat(n))}));return Object(p.jsx)("div",{className:"grid__row",children:n},"grid-row-".concat(t))}));return Object(p.jsx)("div",{className:"grid",children:t})}),$=function(){var e=Object(l.c)((function(e){return e.grid}));return Object(p.jsx)(X,{rows:e.rows})},ee=(n(32),function(e){var t=e.label,n=e.value;return Object(p.jsxs)("div",{className:"stat",children:[Object(p.jsxs)("label",{children:[t,": "]}),Object(p.jsx)("span",{children:n})]})}),te=function(){var e=Object(l.c)((function(e){return e.game}));return Object(p.jsxs)("div",{className:"stats-view-container",children:[Object(p.jsx)(ee,{label:"Level",value:e.level}),Object(p.jsx)(ee,{label:"Score",value:e.score}),Object(p.jsx)(ee,{label:"Lines",value:e.lines})]})},ne=(n(33),function(e){var t=e.isPaused,n=e.tickInterval,r=Object(l.c)((function(e){return e.game.interval})),c=Object(l.b)();return Object(i.useEffect)((function(){if(null==r){var e=setInterval((function(){c(Z())}),n);c(k.createdInterval(e))}}),[c,n,t]),Object(p.jsxs)(o.a.Fragment,{children:[Object(p.jsx)("div",{className:"game-view__grid",children:Object(p.jsx)($,{})}),Object(p.jsxs)("div",{className:"game-view__side-bar",children:[Object(p.jsx)(V,{}),Object(p.jsx)(W,{}),Object(p.jsx)(te,{})]})]})}),re={ArrowDown:Z,ArrowLeft:function(){return K(-1)},ArrowRight:function(){return K(1)},ArrowUp:function(){return e=1,function(t,n){var r=n(),c=r.grid,a=r.current,i=r.next,o=c.gutterRows;if(null==a)return M(t,i);var u=a.position||{x:3,y:0},s=z(o,{type:a.type,orientation:(a.orientation+e)%4,position:u});if(s){t(T.rotate());var l={rows:s?Q(o,a):c.rows,gutterRows:s?o:c.rows};t(G.update(l))}};var e}," ":function(){return function(){console.log("drop: hard")}},p:k.pause,P:k.pause,Shift:F},ce=function(e){return function(t){var n=re[e.key];n&&t(n())}},ae=(n(34),function(){var e=Object(l.b)();return Object(p.jsxs)("div",{className:"pause-view",onKeyDown:function(t){return e(ce(t))},tabIndex:-1,children:[Object(p.jsx)("p",{children:"Pause"}),Object(p.jsx)("button",{onClick:function(){return e(S.actions.pause())},children:"Resume"}),Object(p.jsx)("button",{onClick:function(){return e(Y())},children:"Restart"})]})}),ie=(n(35),n(36),function(){var e=Object(l.b)();return Object(p.jsxs)("div",{className:"game-over-view",children:[Object(p.jsx)("p",{children:"Game Over"}),Object(p.jsx)("button",{onClick:function(){return e(Y())},children:"Start a new game"})]})}),oe=(n(37),function(){var e=Object(l.b)();return Object(p.jsxs)("div",{className:"start-view",children:[Object(p.jsx)("p",{children:"Start a game!"}),Object(p.jsx)("button",{onClick:function(){return e(Y())},children:"Start"})]})}),ue=function(e,t,n,r){return e?Object(p.jsx)(ie,{}):t?n?Object(p.jsx)(ae,{}):Object(p.jsx)(ne,{isPaused:n,tickInterval:r}):Object(p.jsx)(oe,{})},se=function(){var e=Object(l.c)((function(e){return e.game.gameOver})),t=Object(l.c)((function(e){return e.game.hasStarted})),n=Object(l.c)((function(e){return e.game.paused})),r=Object(l.c)((function(e){return e.game.tickInterval})),c=Object(l.b)();return Object(p.jsxs)("div",{className:"tetris-page",onKeyDown:function(e){return c(ce(e))},tabIndex:-1,children:[Object(p.jsx)("div",{className:"tetris-page__title",children:"Tetris"}),Object(p.jsx)("div",{className:"tetris-page__content",children:ue(e,t,n,r)})]})},le=(n(38),function(){return Object(p.jsxs)("div",{className:"app",children:[Object(p.jsx)(j.a,{basename:"/",children:Object(p.jsx)(f.c,{children:Object(p.jsx)(f.a,{path:"/",element:Object(p.jsx)(se,{})})})}),Object(p.jsxs)("footer",{className:"app__footer",children:["made with \u2665 by ",Object(p.jsx)("a",{href:"https://github.com/leahferrell/tetris-react",target:"_blank",rel:"noreferrer",children:"leahferrell"})]})]})}),je=Object(y.a)({reducer:{current:L.reducer,game:S.reducer,grid:_.reducer,hold:A.reducer,next:J.reducer}});n(39);s.a.render(Object(p.jsx)(l.a,{store:je,children:Object(p.jsx)(le,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.b93fc146.chunk.js.map